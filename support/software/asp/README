ASTERICS software support
=========================

Author:   Gundolf Kiefer <gundolf.kiefer@hs-augsburg.de>, 2016-07-31
Modified: Philip Manke <philip.manke@hs-augsburg.de>, 2019-07-04

This directory contains the infrastucture and driver files for the ASTERICS support package (ASP).



BACKGROUND

The purpose of an ASTERICS support package is to provide information on the ASTERICS hardware
to application programs and to encapsulate FPGA- and OS-specific functionality.

Fig. 1 shows the layer model assumed for the software part of a project containing ASTERICS
hardware. The ASP covers layers 1 through 3. Modules marked with an asterisk ('*') are
project-specific and need to be provided by system integrator or may later be generated by
an automatic tool.

The ASTERICS support library <as_support.h/c> (layer 1) contains primitive functions to abstract
from FPGA vendor libraries and OS functionality. It is kept as small as possible in size, and
it does not depend on any particular ASTERICS chain configuration or ASTERICS modules.

The ASTERICS modules layer (layer 2) contains one software driver module for each ASTERICS
hardware module in the particular system. The drivers contain assistive functions 
(e.g. for module initialization/shutdown) and other driver functionality.

Layer 3 contains a main header file (<asterics.h>) which is usually generated by the 
ASTERICS system generator Automatics.
Here the base addresses for the registers of each ASTERICS module in the system are defined.

It should be noted, that non of the ASP other than <as_support.h/c> depends on any module
outside the ASP. However, the main application may, of course, depend on other system libraries
or FPGA-vendor-specific libraries in code sections not related to ASTERICS.

Further information - particularly on the OS abstraction - can be found in <as_support.h>.


    4.                         Application
                                 |   |
                                 |   +-------- (may arbitrarily depend on other
                                 |              system/FPGA vendor/... libraries)
                                 |
          +----------------------------------------------------------------------------+
          |                                                                            |
          |   ASTERICS                                                                 |
    3.    |   <asterics.h>                                                             |
          |   - main include file for applications (just wraps everything below)       |
          |   - Contains slave register base addresses for hardware modules            |
          |                                                                            |
          +-------------+-------------------+-------------------+----------------------+
          |             |                   |                   |                      |
          |             | ASTERICS Module   |  ASTERICS Module  |  ASTERICS Module     |
    2.    |             | <as_[module].h/c> |                   |                      |
          |             | - supporting C    |        ...        |        ...           |
          |             |   functions       |                   |                      |
          |             |                   |                   |                      |
          |             +-------------------+-------------------+----------------------|
          |                                                                            |
          |  ASTERICS Support Library                                                  |
    1.    |   <as_support.h/c>                                                         |
          |   - tiny wrappers for FPGA-vendor functionality                            |
          |   - minimum OS abstraction                                                 |
          |   - This is only part of the ASP that depends on                           |
          |     external code of ANY kind.                                             |
          +----------------------------------------------------------------------------+
                |                |                  
                |                |                  
     0.     FPGA vendor      OS system          

  Fig. 1: ASTERICS software layers



GENERATING AN ASTERICS SUPPORT PACKAGE

To generate a support package for an ASTERICS system, either obtain all necessary source files from running Automatics, or collect and create them manually.
Each hardware module supplies the necessary drivers in <module folder>/drivers/*.[c,h].
Write "asterics.h" yourself by including "as_support.h" and all driver headers of modules.
Use the file "as_main.vhd" to find the base addresses for each module and declare them in "asterics.h".

"asterics.h" should then be included in the board support package for your hardware target to operate ASTERICS hardware.



ASTERICS MODULES

Module drivers typically include <as_support.h> and eventually some header files of
other ASTERICS modules they depend on. They must not include:

a) headers from other ASTERICS modules they do not depend on, 

b) external headers unless there is a really good reason for it.



ASTERICS APPLICATIONS

Applications must include "asterics.h" to get everything related to ASTERICS.
